<form>
    <button hidden></button>
    <mat-form-field>
        <mat-label>id</mat-label>
        <input matInput readonly type="text" [value]="data.id" name="id" />
        <button mat-icon-button matSuffix color="primary" (click)="copyCadId(data)">
            <mat-icon>content_copy</mat-icon>
        </button>
    </mat-form-field>
    <mat-form-field>
        <mat-label>名字</mat-label>
        <input matInput type="text" [value]="data.name" (change)="setCadName(data, $event)" name="name" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>唯一码</mat-label>
        <input matInput type="text" [(ngModel)]="data.info['唯一码']" name="name" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>显示名字</mat-label>
        <input matInput type="text" [(ngModel)]="data.xianshimingzi" name="xianshimingzi" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>分类</mat-label>
        <input matInput type="text" [(ngModel)]="data.type" name="type" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>分类2</mat-label>
        <input matInput type="text" [(ngModel)]="data.type2" name="type2" />
    </mat-form-field>
    <div class="sub-form-field">
        <div class="label">选项</div>
        <div *ngIf="keysOf(data.options).length === 0">
            <button mat-icon-button color="primary" (click)="objectAdd(data.options, '')">
                <mat-icon>add_circle</mat-icon>
            </button>
        </div>
        <div *ngFor="let key of keysOf(data.options)">
            <mat-form-field style="width: 30%">
                <mat-label>选项-键</mat-label>
                <input type="text" matInput [value]="key" (change)="changeObjectKey(data.options, key, $event)" />
            </mat-form-field>
            <mat-form-field style="width: 70%">
                <mat-label>选项-值</mat-label>
                <input type="text" matInput [(ngModel)]="data.options[key]" [ngModelOptions]="{standalone: true}" />
                <button mat-icon-button matSuffix color="primary" (click)="selectOptions(data, 'options', key)">
                    <mat-icon>list</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="objectAdd(data.options, '', '')">
                    <mat-icon>add_circle</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="objectRemove(data.options, key)">
                    <mat-icon>remove_circle</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </div>
    <div class="sub-form-field">
        <div class="label">条件</div>
        <div *ngIf="data.conditions.length === 0">
            <button mat-icon-button color="primary" (click)="arrayAdd(data.conditions, '')">
                <mat-icon>add_circle</mat-icon>
            </button>
        </div>
        <mat-form-field *ngFor="let c of ' '.repeat(data.conditions.length).split(''); let j = index">
            <input matInput type="text" [(ngModel)]="data.conditions[j]" [ngModelOptions]="{standalone: true}" />
            <button mat-icon-button matSuffix color="primary" (click)="arrayAdd(data.conditions, '', j + 1)">
                <mat-icon>add_circle</mat-icon>
            </button>
            <button mat-icon-button matSuffix color="primary" (click)="arrayRemove(data.conditions, j)">
                <mat-icon>remove_circle</mat-icon>
            </button>
        </mat-form-field>
    </div>
    <div class="form-item-group hint">
        <div *ngFor="let b of data.baseLines; let j = index">
            <mat-form-field [color]="getBaselineItemColor(j)">
                <mat-label>基准</mat-label>
                <input matInput type="text" [(ngModel)]="b.name" name="baseLineName" />
                <button mat-icon-button matSuffix [color]="getBaselineItemColor(j)" (click)="selectBaseLine(j)">
                    <mat-icon>linear_scale</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="addBaseLine(data, j)">
                    <mat-icon>add_circle</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="removeBaseLine(data, j)">
                    <mat-icon>remove_circle</mat-icon>
                </button>
                <mat-hint [align]="'start'">x:{{ b.valueX?.toFixed(2) }}, y:{{ b.valueY?.toFixed(2) }}</mat-hint>
            </mat-form-field>
        </div>
    </div>
    <div class="form-item-group hint">
        <div *ngFor="let p of data.jointPoints; let j = index">
            <mat-form-field [color]="getJointPointItemColor(j)">
                <mat-label>连接点</mat-label>
                <input matInput type="text" [(ngModel)]="p.name" name="jointPointName" />
                <button mat-icon-button matSuffix [color]="getJointPointItemColor(j)" (click)="selectJointPoint(j)">
                    <mat-icon>linear_scale</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="addJointPoint(data, j)">
                    <mat-icon>add_circle</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="removeJointPoint(data, j)">
                    <mat-icon>remove_circle</mat-icon>
                </button>
                <mat-hint [align]="'start'">x:{{ p.valueX?.toFixed(2) }}, y:{{ p.valueY?.toFixed(2) }}</mat-hint>
            </mat-form-field>
        </div>
    </div>
    <mat-form-field>
        <mat-label>开料时刨坑</mat-label>
        <mat-select [(ngModel)]="data.kailiaoshibaokeng" name="kailiaoshibaokeng">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>变形方式</mat-label>
        <mat-select [(ngModel)]="data.bianxingfangshi" name="bianxingfangshi">
            <mat-option [value]="'自由'">自由</mat-option>
            <mat-option [value]="'高比例变形'">高比例变形</mat-option>
            <mat-option [value]="'宽比例变形'">宽比例变形</mat-option>
            <mat-option [value]="'宽高比例变形'">宽高比例变形</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>板材纹理方向</mat-label>
        <mat-select [(ngModel)]="data.bancaiwenlifangxiang" name="bancaiwenlifangxiang">
            <mat-option value="垂直">垂直</mat-option>
            <mat-option value="水平">水平</mat-option>
            <mat-option value="不限">不限</mat-option>
            <mat-option value="指定垂直">指定垂直</mat-option>
            <mat-option value="水平">指定水平</mat-option>
            <mat-option value="指定不限">指定不限</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>开料排版方式</mat-label>
        <mat-select [(ngModel)]="data.kailiaopaibanfangshi" name="kailiaopaibanfangshi">
            <mat-option [value]="'自动排版'">自动排版</mat-option>
            <mat-option [value]="'不排版'">不排版</mat-option>
            <mat-option [value]="'必须排版'">必须排版</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>默认开料板材</mat-label>
        <input matInput type="text" [(ngModel)]="data.morenkailiaobancai" name="morenkailiaobancai" />
        <button mat-icon-button matSuffix color="primary" (click)="selectOptions(data, 'bancai', 'morenkailiaobancai')">
            <mat-icon>list</mat-icon>
        </button>
    </mat-form-field>
    <mat-form-field>
        <mat-label>固定开料板材</mat-label>
        <input matInput type="text" [(ngModel)]="data.gudingkailiaobancai" name="gudingkailiaobancai" />
        <button mat-icon-button matSuffix color="primary" (click)="selectOptions(data, 'bancai', 'gudingkailiaobancai')">
            <mat-icon>list</mat-icon>
        </button>
    </mat-form-field>
    <mat-form-field>
        <mat-label>算料处理</mat-label>
        <mat-select [(ngModel)]="data.suanliaochuli" name="suanliaochuli">
            <mat-option [value]="'算料+显示展开+开料'">算料+显示展开+开料</mat-option>
            <mat-option [value]="'算料+开料'">算料+开料</mat-option>
            <mat-option [value]="'算料+显示展开'">算料+显示展开</mat-option>
            <mat-option [value]="'算料'">算料</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>显示宽度标注</mat-label>
        <mat-select [(ngModel)]="data.showKuandubiaozhu" name="showKuandubiaozhu">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>板材厚度方向</mat-label>
        <mat-select [value]="data.bancaihoudufangxiang" name="bancaihoudufangxiang" (selectionChange)="offset($event)">
            <mat-option [value]="'gt0'">方向1</mat-option>
            <mat-option [value]="'lt0'">方向2</mat-option>
            <mat-option [value]="'none'">不指定</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>自定义属性</mat-label>
        <input matInput type="text" disabled name="attributes" />
        <button mat-icon-button matSuffix color="primary" (click)="editAttributes(data)">
            <mat-icon>list</mat-icon>
        </button>
    </mat-form-field>
    <mat-form-field>
        <mat-label>展开</mat-label>
        <input matInput type="text" disabled name="zhankai" />
        <button mat-icon-button matSuffix color="primary" (click)="editZhankai(data)">
            <mat-icon>list</mat-icon>
        </button>
    </mat-form-field>
    <div class="sub-form-field">
        <div class="label">型号花件</div>
        <div *ngIf="keysOf(data.xinghaohuajian).length === 0">
            <button mat-icon-button color="primary" (click)="objectAdd(data.xinghaohuajian, '')">
                <mat-icon>add_circle</mat-icon>
            </button>
        </div>
        <div *ngFor="let key of keysOf(data.xinghaohuajian)">
            <mat-form-field style="width: 50%">
                <mat-label>型号</mat-label>
                <input type="text" matInput [value]="key" (change)="changeObjectKey(data.xinghaohuajian, key, $event)" />
            </mat-form-field>
            <mat-form-field style="width: 50%">
                <mat-label>花件</mat-label>
                <input type="text" matInput readonly [value]="data.xinghaohuajian[key]" />
                <button mat-icon-button matSuffix color="primary" (click)="selectOptions(data, 'huajian', key)">
                    <mat-icon>list</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="objectAdd(data.xinghaohuajian, '', '')">
                    <mat-icon>add_circle</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="objectRemove(data.xinghaohuajian, key)">
                    <mat-icon>remove_circle</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </div>
    <mat-form-field>
        <mat-label>必须绑定花件</mat-label>
        <mat-select [(ngModel)]="data.needsHuajian" name="needsHuajian">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>可独立板材</mat-label>
        <mat-select [(ngModel)]="data.kedulibancai" name="kedulibancai">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>必须选择板材</mat-label>
        <mat-select [(ngModel)]="data['必须选择板材']" name="必须选择板材">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>双向折弯</mat-label>
        <mat-select [(ngModel)]="data.shuangxiangzhewan" name="shuangxiangzhewan">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>算料单显示</mat-label>
        <mat-select [(ngModel)]="data.suanliaodanxianshi" name="suanliaodanxianshi">
            <mat-option *ngFor="let value of sldxs" [value]="value">{{ value }}</mat-option>
        </mat-select>
    </mat-form-field>
    <div class="sub-form-field" *ngFor="let info of insertsectionInfo">
        <div class="label">{{ info.label }}</div>
        <div *ngIf="data[info.key].length === 0">
            <button mat-icon-button color="primary" (click)="arrayAdd(data[info.key], [])">
                <mat-icon>add_circle</mat-icon>
            </button>
        </div>
        <div *ngFor="let v of data[info.key]; let j = index">
            <mat-form-field>
                <input type="text" matInput [value]="v.length ? '已指定' : '未指定'" readonly />
                <button mat-icon-button matSuffix [color]="getPointColor(j, info.key)" (click)="selectPoint(j, info.key)">
                    <mat-icon>linear_scale</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="arrayAdd(data[info.key], [], j + 1)">
                    <mat-icon>add_circle</mat-icon>
                </button>
                <button mat-icon-button matSuffix color="primary" (click)="arrayRemove(data[info.key], j)">
                    <mat-icon>remove_circle</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </div>
    <mat-form-field>
        <mat-label>算料单显示放大倍数</mat-label>
        <input
            type="number"
            step="0.1"
            min="0"
            matInput
            [value]="data.suanliaodanZoom"
            (change)="setNumberValue(data, 'suanliaodanZoom', $event)"
        />
    </mat-form-field>
    <mat-form-field>
        <mat-label>企料前后宽同时改变</mat-label>
        <mat-select type="text" [(ngModel)]="data['企料前后宽同时改变']" name="企料前后宽同时改变">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>主CAD</mat-label>
        <mat-select type="text" [(ngModel)]="data['主CAD']" name="主CAD">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>算料单展开显示位置</mat-label>
        <mat-select type="text" [(ngModel)]="data['算料单展开显示位置']" name="算料单展开显示位置">
            <mat-option *ngFor="let item of sldzkxswz" [value]="item">{{ item }}</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>属于门框门扇</mat-label>
        <mat-select type="text" [(ngModel)]="data['属于门框门扇']" name="属于门框门扇">
            <mat-option value="未区分">未区分</mat-option>
            <mat-option value="门框">门框</mat-option>
            <mat-option value="门扇">门扇</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>内开做分体</mat-label>
        <mat-select type="text" [(ngModel)]="data['内开做分体']" name="内开做分体">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>板材绑定选项</mat-label>
        <input matInput type="text" [(ngModel)]="data['板材绑定选项']" name="板材绑定选项" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>算料单线长显示的最小长度</mat-label>
        <input matInput type="number" [(ngModel)]="data['算料单线长显示的最小长度']" name="算料单线长显示的最小长度" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>检查企料厚度</mat-label>
        <mat-select type="text" [(ngModel)]="data['检查企料厚度']" name="检查企料厚度">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>对应门扇厚度</mat-label>
        <input matInput type="number" [(ngModel)]="data['对应门扇厚度']" name="对应门扇厚度" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>显示厚度</mat-label>
        <input matInput type="text" [(ngModel)]="data['显示厚度']" name="显示厚度" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>跟随CAD开料板材</mat-label>
        <input matInput type="text" [(ngModel)]="data['跟随CAD开料板材']" name="跟随CAD开料板材" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>算料特殊要求</mat-label>
        <textarea
            type="text"
            matInput
            cdkTextareaAutosize
            [cdkAutosizeMaxRows]="5"
            [(ngModel)]="data['算料特殊要求']"
            name="算料特殊要求"
        ></textarea>
    </mat-form-field>
    <mat-form-field>
        <mat-label>正面宽差值</mat-label>
        <input type="number" matInput [value]="data['正面宽差值']" (change)="setNumberValue(data, '正面宽差值', $event)" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>墙厚差值</mat-label>
        <input type="number" matInput [value]="data['墙厚差值']" (change)="setNumberValue(data, '墙厚差值', $event)" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>企料翻转</mat-label>
        <mat-select type="text" [(ngModel)]="data['企料翻转']" name="企料翻转">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>装配位置</mat-label>
        <input type="text" matInput [(ngModel)]="data['装配位置']" name="装配位置" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>企料门框配合位增加值</mat-label>
        <input
            type="number"
            matInput
            [value]="data['企料包边门框配合位增加值']"
            (change)="setNumberValue(data, '企料包边门框配合位增加值', $event)"
            name="企料包边门框配合位增加值"
        />
    </mat-form-field>
    <mat-form-field>
        <mat-label>企料包边类型</mat-label>
        <mat-select type="text" [(ngModel)]="data['企料包边类型']" name="企料包边类型">
            <mat-option *ngFor="let item of qlbmlx" [value]="item">{{ item }}</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>指定封口厚度</mat-label>
        <input type="text" matInput [(ngModel)]="data['指定封口厚度']" name="指定封口厚度" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>拼接料拼接时垂直翻转</mat-label>
        <mat-select type="text" [(ngModel)]="data['拼接料拼接时垂直翻转']" name="拼接料拼接时垂直翻转">
            <mat-option [value]="true">是</mat-option>
            <mat-option [value]="false">否</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>正面线到见光线展开模板</mat-label>
        <mat-hint>切框用的</mat-hint>
        <input type="text" matInput [(ngModel)]="data.info['正面线到见光线展开模板']" name="正面线到见光线展开模板" />
        <button mat-icon-button matSuffix color="primary" (click)="openCadmuban(data.info['正面线到见光线展开模板'])">
            <mat-icon>open_in_new</mat-icon>
        </button>
        <button mat-icon-button matSuffix color="primary" (click)="selectCadmuban()">
            <mat-icon>list</mat-icon>
        </button>
    </mat-form-field>
    <div class="sub-form-field">
        <div class="label">对应计算条数的配件</div>
        <div *ngFor="let key of keysOf(data['对应计算条数的配件'])">
            <mat-form-field style="width: 30%">
                <mat-label>键</mat-label>
                <input type="text" matInput [value]="key" (change)="changeObjectKey(data['对应计算条数的配件'], key, $event)" />
            </mat-form-field>
            <mat-form-field style="width: 70%">
                <mat-label>值</mat-label>
                <input type="text" matInput [(ngModel)]="data['对应计算条数的配件'][key]" [ngModelOptions]="{standalone: true}" />
                <button mat-icon-button matSuffix color="primary" (click)="selectOptions(data, '对应计算条数的配件', key)">
                    <mat-icon>list</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </div>
</form>
