<div #cadContainer (contextmenu)="onContextMenu($event)"></div>
<div
	style="visibility: hidden; position: fixed;"
	[style.left]="contextMenuPosition.x"
	[style.top]="contextMenuPosition.y"
	[matMenuTriggerFor]="contextMenu"
></div>
<mat-menu #contextMenu="matMenu">
	<ng-template matMenuContent>
		<button mat-menu-item (click)="zoomAll()">居中</button>
		<button mat-menu-item (click)="refresh()">刷新</button>
		<button mat-menu-item (click)="toggleAllMenu()">{{ showAllMenu ? "隐藏" : "显示" }}菜单</button>
	</ng-template>
</mat-menu>

<div class="menu top" [@closeTop]="showTopMenu ? 'open' : 'closed'">
	<app-toolbar [cad]="cad" (afterOpenCad)="afterOpenCad()"></app-toolbar>
</div>
<div class="menu left" [@closeLeft]="showLeftMenu ? 'open' : 'closed'">
	<div class="btn-group">
		<button mat-raised-button color="accent" (click)="toolbar.save()">保存</button>
		<mat-icon class="menu-icon left" [class.closed]="!showLeftMenu" (click)="toggleLeftMenu()">
			{{ showLeftMenu ? "navigate_before" : "navigate_next" }}
		</mat-icon>
	</div>
	<app-sub-cads [cad]="cad"></app-sub-cads>
</div>
<div class="menu right" [@closeRight]="showRightMenu ? 'open' : 'closed'">
	<div class="btn-group">
		<mat-icon class="menu-icon right" [class.closed]="!showRightMenu" (click)="toggleRightMenu()">
			{{ showRightMenu ? "navigate_next" : "navigate_before" }}
		</mat-icon>
	</div>
	<perfect-scrollbar>
		<mat-accordion multi>
			<mat-expansion-panel expanded *ngIf="shownMenus.includes('entityInfo')">
				<mat-expansion-panel-header>
					<mat-panel-title>CAD信息</mat-panel-title>
				</mat-expansion-panel-header>
				<mat-tab-group dynamicHeight>
					<mat-tab label="CAD">
						<app-cad-info [cad]="cad" [formulas]="formulas"></app-cad-info>
					</mat-tab>
					<mat-tab label="线段">
						<app-cad-line [cad]="cad"></app-cad-line>
					</mat-tab>
					<mat-tab label="文本">
						<app-cad-mtext [cad]="cad"></app-cad-mtext>
					</mat-tab>
					<mat-tab label="标注">
						<app-cad-dimension [cad]="cad"></app-cad-dimension>
					</mat-tab>
				</mat-tab-group>
			</mat-expansion-panel>
			<mat-expansion-panel expanded *ngIf="shownMenus.includes('cadAssemble')">
				<mat-expansion-panel-header>
					<mat-panel-title>装配CAD</mat-panel-title>
				</mat-expansion-panel-header>
				<app-cad-assemble [cad]="cad" (selectComponent)="selectComponent($event)"></app-cad-assemble>
			</mat-expansion-panel>
		</mat-accordion>
	</perfect-scrollbar>
</div>
<div class="menu bottom" [class.accent]="(cadStatus | async)?.name !== 'normal'" [@closeBottom]="showBottomMenu ? 'open' : 'closed'">
	当前状态：{{ cadStatusStr }}
</div>
