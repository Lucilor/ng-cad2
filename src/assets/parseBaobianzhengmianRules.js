!function r(e,n,t){function a(l,i){if(!n[l]){if(!e[l]){var o="function"==typeof require&&require;if(!i&&o)return o(l,!0);if(u)return u(l,!0);var s=new Error("Cannot find module '"+l+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[l]={exports:{}};e[l][0].call(f.exports,(function(r){return a(e[l][1][r]||r)}),f,f.exports,r,e,n,t)}return n[l].exports}for(var u="function"==typeof require&&require,l=0;l<t.length;l++)a(t[l]);return a}({1:[function(r,e,n){"use strict";var t=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&r[e],t=0;if(n)return n.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&t>=r.length&&(r=void 0),{value:r&&r[t++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(r,e){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var t,a,u=n.call(r),l=[];try{for(;(void 0===e||e-- >0)&&!(t=u.next()).done;)l.push(t.value)}catch(r){a={error:r}}finally{try{t&&!t.done&&(n=u.return)&&n.call(u)}finally{if(a)throw a.error}}return l},u=this&&this.__spread||function(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(a(arguments[e]));return r};Object.defineProperty(n,"__esModule",{value:!0}),n.parseBaobianzhengmianRules=n.BaobianzhengmianDesc=n.BaobianzhengmianRule=void 0;var l=r("../utils/func"),i=r("../NB/Super/TypeCast"),o=r("../NB/Numeric/Calculator"),s=/^正面宽=?((?:\d+[\-\~]\d+)|(?:\d+))$/,f=/^当(.*)时?[,，](.*)$/,c=/(?:无|不要|去除|去掉)(.*)(?:面|线)/,h=/([A-Za-z0-9_\-]+)(?:变化值)?/,v=/斜线(.*)宽=(\d+)(?:.*?)高=(\d+)/,p=/旋转斜线(\w+)(?:.*?)保证角度范围(\d+[\-\~]\d+)/,y=/改斜线(\w+)线长/,d=/(1\/2|1\/4|二分之一|四分之一|半)圆(?:.*?)([A-Za-z0-9_\-]+)宽=(\d+)(?:.*?)高=(\d+)/,m=/^(\<|\<\=|\>|\>\=|\=)(\d+)$/,b=/^(\d+)[\-\~](\d+)$/,g=/^(.*)(\<|\<\=|\>|\>\=|\=)(\d+)$/,N=/^(.*)(\d+)[\-\~](\d+)$/,C=function(r){this.conditions={},this.expression={},r&&(this.type=r)},x=function(){this.zhengmiankuanfanwei="",this.expressions=[]};n.BaobianzhengmianRule=x;var w=function(){this.zhengmiankuanfanwei="",this.rules=[]};function _(r){var e=!1;return l.nameEquals(r,["正面宽","开启","包边方向","门扇厚度","包边分类"])&&(e=!0),e}n.BaobianzhengmianDesc=w,n.parseBaobianzhengmianRules=function(r,e){var n,S,z,O,j,A,E,B,R,I,T,k,F=new w,q=F.rules,$=[],M=function(r){return e&&e[r]||null};if(!r)return{result:F,errors:$};var P=l.split(r,[":",";","\n"]),W=[],D=!1,L=!1,X=!1,Z=!1,Y=function(r){if(l.nameIncludes(r,"修改包边正面宽规则"))return D=!0,L=!0,"continue";if(l.nameIncludes(r,"锁边自动绑定可搭配铰边"))return Z=!0,"continue";if(!D)return"continue";if(Z)return"continue";var e=r.trim().replace(/\s/g,"");if(""==e)return"continue";var n={"：":":","；":";","，":",","（":"(","）":")","。":"."};if(Object.keys(n).forEach((function(r){e=e.replaceAll(r,n[r])})),L){if(L=!1,X=!0,e.startsWith("情况"))return W.push(e),"continue";W.push("情况1")}X&&(X=!1,e.startsWith("正面宽")||W.push("正面宽0-9999")),W.push(e)};try{for(var U=t(P),V=U.next();!V.done;V=U.next()){Y(V.value)}}catch(r){n={error:r}}finally{try{V&&!V.done&&(S=U.return)&&S.call(U)}finally{if(n)throw n.error}}var K=[],G=[],H=!1;try{for(var J=t(W),Q=J.next();!Q.done;Q=J.next()){var rr=Q.value;if(rr.startsWith("要求"))H=!0;else if(H)G.push(rr);else{var er=null;K.length&&(er=K[K.length-1]),rr.match(/^情况\s*\d+/)?(er=[],K.push(er),er.push(rr)):er&&er.push(rr)}}}catch(r){z={error:r}}finally{try{Q&&!Q.done&&(O=J.return)&&O.call(J)}finally{if(z)throw z.error}}var nr=function(r,e){if(!r||!e)return null;var n=new RegExp(r+"(.*\\d+)"),t=e.match(n);if(!t||!t[1])return null;var a=t[1],u=a.match(m),o=a.match(b);if(!u&&!o)return null;var s="";if(u){var f=u[1],c=i.Cast2Number(u[2]);"<"==f?s="0-"+(c-1):"<="==f?s="0-"+c:">"==f?s=c+1+"-9999":">="==f?s=c+"-9999":"="==f&&(s=c+"-"+c)}else if(o){var h=l.formatRange(o[0]);h[0]&&h[1]&&(s=h[0]+"-"+h[1])}return s||null};try{for(var tr=t(G),ar=tr.next();!ar.done;ar=tr.next()){var ur,lr=ar.value;if(lr.startsWith("正面宽"))(ur=nr("正面宽",lr))?F.zhengmiankuanfanwei=ur:$.push("要求：无法识别表达式："+lr);else if(lr.startsWith("封边正面差值"))if(ur=nr("封边正面差值",lr))try{for(var ir=(E=void 0,t(K)),or=ir.next();!or.done;or=ir.next()){or.value.push("全局要求："+lr)}}catch(r){E={error:r}}finally{try{or&&!or.done&&(B=ir.return)&&B.call(ir)}finally{if(E)throw E.error}}else $.push("要求：无法识别表达式："+lr);else if(lr.match(f))try{for(var sr=(R=void 0,t(K)),fr=sr.next();!fr.done;fr=sr.next()){fr.value.push("全局要求："+lr)}}catch(r){R={error:r}}finally{try{fr&&!fr.done&&(I=sr.return)&&I.call(sr)}finally{if(R)throw R.error}}else $.push("要求：无法识别表达式："+lr)}}catch(r){j={error:r}}finally{try{ar&&!ar.done&&(A=tr.return)&&A.call(tr)}finally{if(j)throw j.error}}var cr=function(r){var e,n;if(0==r.length)return"continue";var m=r.shift();if(0==r.length)return $.push(m+"：空规则"),"continue";var b=new x,w=r.shift(),S=w.match(s),z=!S&&nr("正面宽",w);S&&S[1]?i.IsNumber(S[1])?b.zhengmiankuanfanwei=S[1]+"-"+S[1]:b.zhengmiankuanfanwei=S[1]:z?b.zhengmiankuanfanwei=z:($.push(m+"：无法识别正面宽范围，必须以 “正面宽XXX-YYY” 作为一种情况的开始，现在格式："+w),r.unshift(w),b.zhengmiankuanfanwei="0-9999");var O=function(r){var e,n,s,x,w=new C,S=m;r.startsWith("全局要求：")&&(S="要求",r=r.replace(/^全局要求：/,""));var z="",O=r,j=r.match(f);if(null!=j){z=j[1],O=j[2];for(var A=l.split(z,",").map((function(r){return r.replace(/时$/,"")})),E=l.split(O,",").map((function(r){return r.replace(/时$/,"")})),B=0;B<A.length;B++){var R=A[B],I=l.split(R,[">=","<=","="]),T=!0;if(!(T=(T=(T=T&&R.includes("="))&&2==I.length)&&_(I[0]))){z=A.slice(0,B).join(","),O=u(A.slice(B),E).join(",");break}}var k=l.split(z,",");try{for(var F=(e=void 0,t(k)),q=F.next();!q.done;q=F.next()){var P=q.value;if(P)if(2==(yr=l.split(P,"=")).length){var W=a(yr,2),D=W[0],L=W[1];if(_(D))w.conditions[D]=L;else{var X=P.match(g),Z=P.match(N),Y="",U="";if(X){Y=X[1];var V=X[2],K=i.Cast2Number(X[3]);"<"==V?U="0-"+(K-1):"<="==V?U="0-"+K:">"==V?U=K+1+"-9999":">="==V?U=K+"-9999":"="==V&&(U=K+"-"+K)}else if(Z){Y=Z[1];var G=l.formatRange(Z[2]+"-"+Z[3]);G[0]&&G[1]&&(U=U[0]+"-"+U[1])}U?w.conditions[Y]=U:$.push(S+"：无法识别子条件："+P)}}else $.push(S+"：无法识别子条件："+P)}}catch(r){e={error:r}}finally{try{q&&!q.done&&(n=F.return)&&n.call(F)}finally{if(e)throw e.error}}}var H=O.match(c);if(H){w.type="移除";var J=l.split(H[1],[",","、"]),Q=0;try{for(var rr=(s=void 0,t(J)),er=rr.next();!er.done;er=rr.next()){var tr=er.value;if(tr)(Nr=M(tr))?l.nameIncludes(Nr,Object.values(w.expression))||(w.expression["不要"+ ++Q]=Nr):$.push(S+"：没有标面："+tr+"面")}}catch(r){s={error:r}}finally{try{er&&!er.done&&(x=rr.return)&&x.call(rr)}finally{if(s)throw s.error}}}var ar=O.match(v);if(ar){if(!(Nr=M(ar[1])))return $.push(S+"：没有标面："+ar[1]+"面"),"continue";w.type="修改",w.expression["斜线宽高"+Nr]=ar[2]+","+ar[3]}var ur=O.match(p);if(ur){if(!(Nr=M(ur[1])))return $.push(S+"：没有标面："+ur[1]+"面"),"continue";if(!(U=l.formatRange(ur[2],!0))[0]||!U[1])return $.push(S+"：旋转斜线表达式错误："+O),"continue";w.type="修改",w.expression["旋转斜线"+Nr]=U[0]+"-"+U[1]}var lr=O.match(y);if(lr){if(!(Nr=M(lr[1])))return $.push(S+"：没有标面："+lr[1]+"面"),"continue";w.type="修改",w.expression["改斜线长"+Nr]="?,?"}var ir=O.match(d);if(ir){if(!(Nr=M(ir[2])))return $.push(S+"：没有标面："+ir[1]+"面"),"continue";var or=ir[1];"二分之一"==or||"半"==or?or="1/2":"四分之一"==or&&(or="1/4"),w.type="修改",w.expression["改圆弧"+Nr]=or+","+ir[3]+","+ir[4]}var sr=O.startsWith("封边正面差值");if(sr){var fr=nr("封边正面差值",O);if(!fr)return $.push(S+"：无法识别封边正面差值："+O),"continue";w.type="要求",w.expression["封边正面差值"]=fr}var cr=!1,hr=nr("(?:[A-Za-z0-9_-])+",O);if(hr){var vr=O.match(/^([A-Za-z0-9_\-])+/)[1];if(!(Nr=M(vr)))return $.push(S+"：没有标面："+vr+"面"),"continue";cr=!0,w.type="要求",w.expression[Nr]=hr}var pr=!1;if(!(H||ar||ur||lr||ir||sr||cr)&&l.nameIncludes(O,"=")&&!l.nameIncludes(O,">=")&&!l.nameIncludes(O,"<=")){var yr;if(2!=(yr=l.split(O,"=")).length)return $.push(S+"：无法识别表达式："+O),"continue";_(yr[0])||(yr[0].match(h)||yr[1].match(h)||yr[1].match(/\d/)||yr[1].includes("变化值"))&&(pr=!0)}if(pr){var dr=a(l.split(O,"="),2),mr=dr[0],br=dr[1],gr=mr.match(h);if(gr){var Nr;if(!(Nr=M(gr[1])))return $.push(S+"：没有标面："+gr[1]+"面"),"continue";mr=mr.replace(gr[1],Nr)}br=o.Calculator.normalizeVars(br,(function(r){if(l.nameEquals(r,["变化值","总变化值"]))return"包边正面宽变化值";var e=r.match(h);if(e){var n=M(e[1]);if(n)return r.replace(e[1],n);$.push(S+"：没有标面："+e[1]+"面")}})),w.type="修改",w.expression[mr]=br}if(!(H||ar||ur||lr||ir||sr||pr||cr))return $.push(S+"：无法识别表达式："+O),"continue";b.expressions.push(w)};try{for(var j=(e=void 0,t(r)),A=j.next();!A.done;A=j.next()){O(A.value)}}catch(r){e={error:r}}finally{try{A&&!A.done&&(n=j.return)&&n.call(j)}finally{if(e)throw e.error}}var E={};b.expressions.forEach((function(r){if("修改"!=r.type)return!1;Object.keys(r.expression).forEach((function(e){var n=e.match(h);if(n){var t=n[1];E[t]||(E[t]=[]),E[t].push(e+"="+r.expression[e])}}))})),Object.keys(E).forEach((function(r){var e=E[r];e.length>1&&$.push(m+"：公式重复："+e.join("、"))})),q.push(b)};try{for(var hr=t(K),vr=hr.next();!vr.done;vr=hr.next()){cr(vr.value)}}catch(r){T={error:r}}finally{try{vr&&!vr.done&&(k=hr.return)&&k.call(hr)}finally{if(T)throw T.error}}return $.length&&e&&Object.keys(e).forEach((function(r){for(var n=e[r],t=0;t<$.length;t++)$[t]=$[t].replaceAll(n,r)})),{result:F,errors:$=Array.from(new Set($))}}},{"../NB/Numeric/Calculator":2,"../NB/Super/TypeCast":3,"../utils/func":4}],2:[function(require,module,exports){"use strict";var __read=this&&this.__read||function(r,e){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var t,a,u=n.call(r),l=[];try{for(;(void 0===e||e-- >0)&&!(t=u.next()).done;)l.push(t.value)}catch(r){a={error:r}}finally{try{t&&!t.done&&(n=u.return)&&n.call(u)}finally{if(a)throw a.error}}return l};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Calculator=void 0;var TypeCast_1=require("../Super/TypeCast"),Calculator=function(){function Calculator(){}return Calculator.add=function(r,e){return(parseFloat(r||"0")+parseFloat(e||"0")).toString()},Calculator.sub=function(r,e){return(parseFloat(r||"0")-parseFloat(e||"0")).toString()},Calculator.mul=function(r,e){return(parseFloat(r||"0")*parseFloat(e||"0")).toString()},Calculator.div=function(r,e){return(parseFloat(r||"0")/parseFloat(e||"0")).toString()},Calculator.calcAddSubFormula=function(r){for(var e="0",n="+",t=0,a=0;a<r.length;a++){var u=r[a];if("+"==u||"-"==u){var l=r.substr(t,a-t);"+"==n?e=Calculator.add(e,l):"-"==n&&(e=Calculator.sub(e,l)),n=u,t=a+1}}if(t<r.length){l=r.substr(t,r.length-t);"+"==n?e=Calculator.add(e,l):"-"==n&&(e=Calculator.sub(e,l))}return e},Calculator.lastNum=function(r){for(var e=0,n=0;n<r.length;n++){var t=r[n];if((t<"0"||t>"9")&&"."!=t){e=n+1;break}}return r.substr(e)},Calculator.firstNum=function(r){for(var e=r.length,n=0;n<r.length;n++){var t=r[n];if((t<"0"||t>"9")&&"."!=t&&"-"!=t){e=n;break}}return r.substr(0,e)},Calculator.calcNormalFormula=function(formula){var evalResult=NaN,mulIndex,divIndex,index,left,a,right,b,result;try{evalResult=Number(eval(formula))}catch(r){}return evalResult.toString()},Calculator.format=function(r){return r?r.toString().replace(/ /g,"").replace(/[xX]/g,"*").replace(/÷/g,"/").replace(/＋/g,"+").replace(/－/g,"-").replace(/（/g,"(").replace(/）/g,")"):r},Calculator.analyze=function(r){return Array.from(new Set((r||"").split(/[\+\-\*\/\(\)\.]/).filter((function(r){return r&&isNaN(TypeCast_1.Cast2Number(r))}))))},Calculator.normalizeVars=function(r,e){if(!r)return"";for(var n=[],t=["+","-","*","/","(",")"],a=0,u=0;u<r.length;u++){var l=r[u];t.includes(l)&&(u-a!=0&&n.push(r.substring(a,u)),a=u+1,n.push(l))}a!=r.length&&n.push(r.substring(a));for(u=0;u<n.length;u++){var i=n[u];i&&!t.includes(i)&&(TypeCast_1.IsNumber(i)||(n[u]=e(i)||i))}return n.join("")},Calculator.calcute=function(r,e,n){if(TypeCast_1.IsNumber(r))return Number(r);r=Calculator.format(r),(n||this.analyze(r)).forEach((function(n){var t;r=r.replace(new RegExp(n,"g"),e?null===(t=e(n))||void 0===t?void 0:t.toString():null)}));var t=r.indexOf("(");if(-1==t)return parseFloat(Calculator.calcNormalFormula(r));var a=r.lastIndexOf(")");if(-1==a)return NaN;var u=r.substr(0,t),l=r.substr(t+1,a-t-1),i=r.substr(a+1);return Calculator.calcute(u+Calculator.calcute(l,e)+i,e)},Calculator.calculateBatch=function(r,e){var n=[];Array.isArray(r)?n=r.filter((function(r){return-1!=r.indexOf("=")})).map((function(r){var e=__read(r.split("="),2);return{name:e[0],formula:e[1]}})):"object"==typeof r&&(n=Object.keys(r).map((function(e){return{name:e,formula:r[e]}})));var t={};return n.forEach((function(r){t[r.name]||(t[r.name]=Calculator.calcute(r.formula,(function(r){return null!=t[r]?t[r]:e?e(r):null})))})),t},Calculator}();exports.Calculator=Calculator},{"../Super/TypeCast":3}],3:[function(r,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Cast2String=n.Cast2Number=n.IsNumber=n.Cast2Bool=void 0,n.Cast2Bool=function(r){return null!=r&&!1!==r&&("number"==typeof r?0!=r:"string"!=typeof r||""!=r&&"0"!=r&&"否"!=r&&"无"!=r)},n.IsNumber=function(r){return"number"==typeof r?!isNaN(r):!!r&&/^-?\d+(?:\.\d+)?$/.test(r)},n.Cast2Number=function(r){if("number"==typeof r&&!isNaN(r))return r;var e=Number(r);return isNaN(e)?parseFloat(r):e},n.Cast2String=function(r){return null==r?"":"boolean"==typeof r?r?"1":"0":r.toString()}},{}],4:[function(r,e,n){"use strict";var t=this&&this.__read||function(r,e){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var t,a,u=n.call(r),l=[];try{for(;(void 0===e||e-- >0)&&!(t=u.next()).done;)l.push(t.value)}catch(r){a={error:r}}finally{try{t&&!t.done&&(n=u.return)&&n.call(u)}finally{if(a)throw a.error}}return l},a=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&r[e],t=0;if(n)return n.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&t>=r.length&&(r=void 0),{value:r&&r[t++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.split=n.nameEquals=n.nameIncludes=n.formatRange=void 0;var u=r("../NB/Super/TypeCast");n.formatRange=function(r,e){var n,a;void 0===e&&(e=!0);var l=-99999,i=99999;if(!r)return[l,i];if(r.includes("~")){if(2!=(f=r.split("~")).length)return[l,i];var o=f[0]?u.Cast2Number(f[0]):l;isNaN(o)&&(o=e?null:l);var s=f[1]?u.Cast2Number(f[1]):i;return isNaN(s)&&(o=e?null:i),o>s&&(o=(n=t([s,o],2))[0],s=n[1]),[o,s]}if(r.includes("-")){var f;o=l,s=i;return 2==(f=r.split("-")).length?(o=f[0]?u.Cast2Number(f[0]):l,isNaN(o)&&(o=e?null:l),s=f[1]?u.Cast2Number(f[1]):i,isNaN(s)&&(o=e?null:i)):3==f.length?f[0]||!f[1]||f[2]?f[0]||f[1]||!f[2]?!f[0]&&f[1]&&f[2]?(o=u.Cast2Number(f[1]),o=isNaN(o)?e?null:l:-o,s=u.Cast2Number(f[2]),isNaN(s)&&(o=e?null:i)):e&&(o=null,s=null):(s=u.Cast2Number(f[2]),s=isNaN(s)?e?null:i:-s):(o=u.Cast2Number(f[1]),o=isNaN(o)?e?null:l:-o):4==f.length&&!f[0]&&f[1]&&!f[2]&&f[3]?(o=u.Cast2Number(f[1]),o=isNaN(o)?e?null:l:-o,s=u.Cast2Number(f[3]),s=isNaN(s)?e?null:i:-s):e&&(o=null,s=null),o>s&&(o=(a=t([s,o],2))[0],s=a[1]),[o,s]}return e?[null,null]:[l,i]},n.nameIncludes=function(r,e,n){if(!r)return null;"string"==typeof e&&(e=[e]);var t=Array.isArray(e)?null:e;t||(t={},e.forEach((function(r){t[r]=[r]})));var a=function(e){if(t.hasOwnProperty(e)){var a=t[e];n&&(a=a.map((function(r){return r.toLowerCase()})));var u=n?r.toLowerCase():r;if(null!=a.find((function(r){return u.includes(r)})))return{value:e}}};for(var u in t){var l=a(u);if("object"==typeof l)return l.value}return null},n.nameEquals=function(r,e,n){if(!r)return null;"string"==typeof e&&(e=[e]);var t=Array.isArray(e)?null:e;t||(t={},e.forEach((function(r){t[r]=[r]})));var a=function(e){if(t.hasOwnProperty(e)){var a=t[e];n&&(a=a.map((function(r){return r.toLowerCase()})));var u=n?r.toLowerCase():r;if(null!=a.find((function(r){return u===r})))return{value:e}}};for(var u in t){var l=a(u);if("object"==typeof l)return l.value}return null},n.split=function(r,e,n){var t,u,l,i;if(void 0===n&&(n=!0),!r)return[];var o="!!S@T#O$K%E^N!!";if(e&&0!=e.length){Array.isArray(e)||(e=[e]);try{for(var s=a([[";","；"],[",","，"],[":","："],["+","＋"],["*","×"]]),f=s.next();!f.done;f=s.next()){var c=f.value,h=e.includes(c[0]),v=h&&e.includes(c[1]);h&&!v&&e.push(c[1])}}catch(r){t={error:r}}finally{try{f&&!f.done&&(u=s.return)&&u.call(s)}finally{if(t)throw t.error}}}else e=["*",";",",","；","，"];try{for(var p=a(e),y=p.next();!y.done;y=p.next()){var d=y.value;r=r.replaceAll(d,o)}}catch(r){l={error:r}}finally{try{y&&!y.done&&(i=p.return)&&i.call(p)}finally{if(l)throw l.error}}var m=r.split(o);if(n)for(var b=0;b<m.length;b++)m[b]=m[b].trim();return m}},{"../NB/Super/TypeCast":3}],5:[function(r,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=r("./TSModule/CAD/BaobianzhengmianRule");window.parseBaobianzhengmianRules=t.parseBaobianzhengmianRules},{"./TSModule/CAD/BaobianzhengmianRule":1}]},{},[5]);